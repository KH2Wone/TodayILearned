# CSR & SSR

<br>

## MPA, SPA부터 살펴볼까요.

### 전통 방식이 있었단 말이여, MPA

Multi Page Application의 약자로, 여러 페이지로 구성된 웹 어플리케이션입니다.  
해당 사이트 내에서 다른 페이지를 누르면 서버에서 새로운 HTML 문서를 받아와서 해당 링크로 이동해 페이지 전체를 새로 렌더링하는 방식이죠. 깜빡깜빡(Blinking)거리기 때문에 사용자의 흐름을 방해합니다.

### 하나면 충분하다, SPA

Single Page Application의 약자로, 하나의 페이지로 구성된 웹 어플리케이션 입니다.
브라우저에서 최초로 한번 모든 정적 리소스를 다운로드합니다.
새로운 페이지 요청이 있을 때, 페이지 갱신에 필요한 데이터(즉, 변화가 일어난 데이터)만 전달 받아서 페이지를 갱신합니다.

<br>

## 진짜 주인공들을 등장시키기 전에 역사부터 살펴봅시다.

1990년대에는 서버에 이미 배포되어 있는 HTML 문서를 받아와서 보여주는 형식이었습니다. 앞서 말했던 MPA방식이었던 것이죠.

1998년, XMLHttpRequest이 개발되면서 JSON 형태의 포맷으로 서버에서 필요한 데이터만 받아올 수 있게 됩니다.  
JS를 이용해서 동적으로 HTML 요소를 생성해 페이지에 업데이트하는 방식입니다.

2005년, 이 방식을 AJAX라고 명명합니다.
이것이 SPA입니다.
사용자가 한 페이지내에서 머무르면서 필요한 데이터를 서버에서 받아와 부분적으로만 업데이트하게 되지요.

### 이제 PC 성능도 좋아지고 자바스크립트 표준화가 잘 되었구만

프레임워크 삼대장 Angular, React, Vue가 등장합니다.

<br>

## 클라이언트에서 다 해먹어라, CSR(Client Side Rendering)

사용자의 요청에 따라 필요한 부분만 응답 받아 클라이언트에서 웹페이지를 렌더링하는 것을 말합니다.

```html
<body>
  <div id="root"></div>
  <script src="app.js"></script>
</body>

```

서버에서 `index.html` 파일을 클라이언트에 보내주면 CSR에서 사용되는 예제처럼 body 안에 `id="root"`인 div 태그 하나, `app.js` script 링크 이 두 가지만 있습니다.  
이처럼 HTML 텅텅 비어있으므로 처음에 접속하면 빈 화면만 보이겠죠?  
링크된 자바스크립트를 서버로부터 다운로드 받는데 이 자바스크립트 안에 어플리케이션에서 필요한 로직, 프레임워크와 라이브러리의 소스코드도 모두 포함되어 있습니다.  
그럼 그만큼 크기가 크니까 다운로드 받는데 시간이 걸립니다.  
추가로 필요한 데이터가 있을 때마다 서버에 요청해 JSON 형태로 데이터를 받아 이를 기반으로 동적으로 HTML을 생성해 사용자에게 최종적으로 보여주게 됩니다.

### 장점

변경된 부분만 요청하니 속도도 빠르고 서버의 부담을 줄일 수 있습니다.  
페이지 안에 컨텐츠를 클릭하여 다음단계로 넘어가는 과정에서 링크가 없으니까 Blink(깜빡 깜빡) 현상이 없어서 사용자 친화적이라고 볼 수 있죠.

### 단점

처음에 모든 JS 파일을 다운받아야 하니까 사용자가 첫 화면을 보기전까지 시간이 걸릴 수 있다는 점과 좋지 않은 SEO가 있겠네요.

<br>

## 서버에서 알아서 할게, SSR(Server Side Rendering)

CSR의 문제점 때문에 SSR이 도입됩니다.

서버로부터 완전하게 만들어진 HTML 파일을 받아와 페이지 전체를 렌더링하는 방식입니다.

웹사이트에 접속하면 서버에서 필요한 데이터를 모두 가져와서 HTML 파일을 만들고 이 파일을 동적으로 제어할 수 있는 소스코드와 함께 클라이언트에게 보내줍니다. 그러면 클라이언트에서 이 문서를 받아와 사용자에게 보여줄수 있게 되지요.

### 장점

서버로부터 화면을 렌더하기 위한 필수적인 요소를 먼저 가져오기 때문에 첫 페이지 로딩이 빠릅니다.  
모든 컨텐츠가 HTML 담겨 있어서 효율적인 SEO를 할 수 있습니다.

### 단점

Blinking 이슈가 발생합니다.
사용자가 클릭을 할 때마다 서버에 요청해서 필요한 데이터를 가져와 HTML을 만들어야 하므로 서버가 과부화 걸리기 쉽습니다.

그리고 사용자가 초기에 빠르게 웹사이트를 확인할 수는 있지만 동적으로 데이터를 처리하는 자바스크립트를 아직 다운로드 받지 못해서 여기저기 클릭해도 반응이 없는 경우가 발생할 수 있습니다.

즉, TTV(Time To View)와 TTI(Time To Interact) 간에 시간 간격이 존재하게 된다는 것이죠.

<br>

## 그럼 SPA === CSR && MPA === SSR 인가요?

모두 그런건 아닙니다.

SPA를 CSR방식으로 MPA를 SSR방식으로 렌더링한다고 말하는 것이지, 모든 SPA가 CSR이다 그리고 모든 MPA가 SSR방식이라고는 할 수 없습니다.

이 두 개념은 페이지의 개수, 렌더링을 어디에서 하느냐에 따라 달라지기 때문에 엄연히 다르다고 할 수 있습니다.

<br>

## 참고

- [SSR(서버사이드 렌더링)과 CSR(클라이언트 사이드 렌더링)](https://miracleground.tistory.com/165)
- [서버사이드 렌더링 (개발자라면 상식으로 알고 있어야 하는 개념 정리 ⭐️)](https://youtu.be/iZ9csAfU5Os)
- [[10분 테코톡] 🎨 신세한탄의 CSR&SSR](https://youtu.be/YuqB8D6eCKE)
